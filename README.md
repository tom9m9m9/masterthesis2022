# masterthesis2022
2022年度修士論文の作成において用いたプログラム及びデータセットを公開します．

## data
実験に用いたデータセットです．
100Walksはwalk，AIST++はaistと略し保存してあります．
- annotation
: AIST++データの副詞アノテーション(.csv)
- doc
: 各データセットにおける文書(副詞の集合)
- voca
: 各データセットにおける語彙(副詞の種類)
- gplvm
: 次元圧縮後のデータ
- smk
: 周波数情報に関するデータ
- advdist.py
: 収集した副詞の分布を表示
- uni.py
: 学習前の単語分布を用いてパープレキシティを計算


## gplvm
GPLVMを用いて姿勢データを低次元に圧縮するプログラムです．
総計数理研究所の持橋大地氏にサンプルプログラムをいただき一部改変しました．
- gplvm.py
: メインプログラム．3次元に圧縮し，結果をtxtファイルに出力
- opts.py
: オプション入力に関する補助プログラム
- printf.py
: イテレーションの出力に関する補助プログラム
- putil.py
: matplotでのグラフ描画に関する補助プログラム
- scg.py
: SCG(最適化関数)に関するプログラム


## smkernel
SMKernelを用いて関数から周波数成分を取り出すプログラムです．
GPytorchに実装されているSpectralMixtureKernelを周波数成分が出力できるように一部改変しています．
- smk.py
: メインプログラム．各カーネルの重み(w)，平均(m)，分散(v)を推定したのち，結果をtxtファイルに出力
- plotgauss.py
: 推定した周波数成分を用いてガウス分布を描画


## hdpsmlda
提案手法であるHDP-SMLDAに関するプログラムです．
- hdpsmlda.py
: メインプログラム．推定した各トピックに対応するガウス分布の平均と単語分布をtxtファイルに出力．各イテレーションごとにパープレキシティを出力．
- plot3dgauss.py
: 推定した各トピックに対応する平均をパラメータとする3次元ガウス分布から100個のサンプルを出力し描画
- top3.py
: 推定したトピック別単語分布を用いて確率上位n個を表示
- output
: モデルが推定した平均(mu)，単語分布(summary)，テスト文書における確率上位10語(test)


## lda
比較のため用いたLDAに関するプログラムです．
- lda.py
: メインプログラム．推定した各トピックに対応する単語分布をtxtファイルに出力．各イテレーションごとにパープレキシティを出力．
- lda_top10.py
: 推定したトピック別単語分布を用いて確率上位n個を表示
- npmi.py
: 推定したトピック別単語分布を用いてNPMI上位n個を表示


## nn
比較のため用いたLSTMと多層パーセプトロンに関するプログラムです．
- lstm.py
: LSTMを用いて副詞分類器を訓練したモデルを保存
- mlp.py
: MLPを用いて副詞分類器を訓練したモデルを保存
- lstm_test.py
: LSTMで訓練されたモデルを用いてテスト文書におけるパープレキシティを計算
- mlp_test.py
: MLPで訓練されたモデルを用いてテスト文書におけるパープレキシティを計算
- loss
: 各モデルにおけるloss
- model
: 保存されたモデル
